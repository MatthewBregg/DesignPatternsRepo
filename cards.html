<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>cards</title>
<!-- 2015-11-18 Wed 17:55 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Design Patterns Team" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">cards</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Card shape</a></li>
<li><a href="#sec-2">2. Decal</a>
<ul>
<li><a href="#sec-2-1">2.1. Decal types</a></li>
<li><a href="#sec-2-2">2.2. Nesting</a></li>
<li><a href="#sec-2-3">2.3. Layout class</a>
<ul>
<li><a href="#sec-2-3-1">2.3.1. General patterns</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-3">3. Theming</a></li>
<li><a href="#sec-4">4. Cards</a></li>
<li><a href="#sec-5">5. Example UML</a></li>
<li><a href="#sec-6">6. Older javascripty idea</a>
<ul>
<li><a href="#sec-6-1">6.1. Scripting</a>
<ul>
<li><a href="#sec-6-1-1">6.1.1. Configuration file</a></li>
<li><a href="#sec-6-1-2">6.1.2. Script</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-7">7. Example with new lisp for 52 cards</a></li>
<li><a href="#sec-8">8. Render method</a></li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Card shape</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>Rectangle, circle, etc
</li>
<li>Corners, rounded, sharp?
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Decal</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>Generic art, gets an art object
</li>
<li>Decals will need to be patterned, one decal might want to be on each corner, or might want to go in a row, would be very awkward to have to manually do all this patterning : Decal shouldn't do patterning, let the transformation class do it.
</li>
</ul>
</div>
<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Decal types</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>Image decals
</li>
<li>Number decals
</li>
<li>Text decals
</li>
<li>Shape decal 
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Nesting</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Layouts will want to be nested, a text box might want to be on top of a back ground.
</p>
</div>
</div>
<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> Layout class</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Composite, leafs hold decal.
</p>
<ul class="org-ul">
<li>Could then handle patterning
</li>
<li>Composite
</li>
</ul>
</div>

<div id="outline-container-sec-2-3-1" class="outline-4">
<h4 id="sec-2-3-1"><span class="section-number-4">2.3.1</span> General patterns</h4>
<div class="outline-text-4" id="text-2-3-1">
<ul class="org-ul">
<li>Textbox
</li>
<li>Border
</li>
<li>Etc?
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Theming</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li>Sub decks
</li>
<li>Some sets will have the same decal applied to the same spot
</li>
<li>Others will have the same decal, but used in a different spot per card
<ul class="org-ul">
<li>EX) Cards have some number of $family decals, but those decals are in different spots, they don't know what image they are until we tell it its family. Thus, would say something like $family = spades, and all the $family decals will use the spades image.

<pre class="example">
clone =  prototype.clone();
clone.setDecal("family",spades);
</pre>
<p>
Families will still need per card information.
So perhaps&#x2026;
</p>
<pre class="example">
clone.setCharacter(charizard.jpg)
clone.setHP(120);
</pre>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Cards</h2>
<div class="outline-text-2" id="text-4">
<p>
Card has a layout. Layouts can be cloned. 
Cards can be cloned. Everything is immutable, so not anymore really.
</p>
<ul class="org-ul">
<li>Card will have a name.
</li>
<li>Card will have a layout, front and back.
</li>
<li>Card have a family? Family is just a map, string -&gt; decal, Two types of layout leafs. FamilyLeaf, which just has a string, asks its family. DecalLeaf, which holds a decal.
<ul class="org-ul">
<li>Cards will not have a family, family given to render.
</li>
<li>A family can be nested, will query its map, then parent map.
<ul class="org-ul">
<li>Families aren't nested, instead render takes in a list, checks all, uses first it finds. 
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Example UML</h2>
<div class="outline-text-2" id="text-5">
<p>
This should probably be split into multiple diagrams.
\newline
</p>

<div class="figure">
<p><img src="InitialCardsUmlqafd.png" alt="InitialCardsUmlqafd.png" />
</p>
</div>

<ul class="org-ul">
<li>Some patterns used here
<ul class="org-ul">
<li>Proxy : the dynamicleaflayout
</li>
<li>Composite : The layouts
</li>
<li>Adapter : Image Decal
</li>
<li>Iterator : For the composite 
</li>
</ul>
</li>
</ul>
</div>
</div>



<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> Older javascripty idea</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> Scripting</h3>
<div class="outline-text-3" id="text-6-1">
</div><div id="outline-container-sec-6-1-1" class="outline-4">
<h4 id="sec-6-1-1"><span class="section-number-4">6.1.1</span> Configuration file</h4>
<div class="outline-text-4" id="text-6-1-1">
<div class="org-src-container">

<pre class="src src-javascript">decal = ...; //Some image file...
LeafDecalFoo = { "position" : ..., "decal" : decal }
LeafDecalBar = { "position" : ..., "decal" : "suite" }
positionA = [ 50, 100, 50, 100 ]
positionB = [ 50, 100, 50, 100 ]
LayoutB = { "position" : positionB, "leafa":LeafDecalBar, "leafb":LeafDecalFoo };

LayoutC = {
    "position" : positionA;
    "layoutA" : {"position" : positionA, "foo" :LeafDecalFoo, "bar":LeafDecalBar },
    "layoutB" : LayoutB
}

LayoutD = {
    "position" : positionB,
    "layoutA" : LayoutC, //"layoutA" is a clone of LayoutC
    "layoutB" : LayoutC["layoutA"] //"layoutB" is a clone of LayoutC["layoutA"]
}
LayoutD["layoutA"]["position"] = [0,100,0,100];


//Layouts are always cloned! But they point to the same, immutable decals,
//so they are cheap to clone.
backgroundDecal = ..;
heartDecal = ...;
clubDecal = ...;
familyBackground = {
    family : null,
    "background" : backgroundDecal
}
heartFamily = {
    family : familyBackground,
    "suite" : heartDecal
}

clubFamily = {
    family : familyBackground,
    "suite" : clubDecal
}

CardOne = {
    "name" = "cardA",
    "LayoutFront" = LayoutD,
    "LayoutBack" = LayoutC,
    family = heartFamily
}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-6-1-2" class="outline-4">
<h4 id="sec-6-1-2"><span class="section-number-4">6.1.2</span> Script</h4>
<div class="outline-text-4" id="text-6-1-2">
<div class="org-src-container">

<pre class="src src-javascript">CardSetA = [CardOne,CardOne];
CardSetB = CardOne.clone(10);
CardSetA.setFamily(clubFamily);
CardSetA.add(CardOne);
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> Example with new lisp for 52 cards</h2>
<div class="outline-text-2" id="text-7">
<div class="org-src-container">

<pre class="src src-config">spadeImage = Image("spadeImage.jpg")
heartImage = Image("heartImage.jpg")
diamondImage = Image("diamondImage.jpg")
clubImage = Image("clubImage.jpg")

jackImage = Image("jack.jpg")
queenImage = Image("queen.jpg")
kingImage = Image("king.jpg")

whiteRectangle = Rectangle("white")
wholeCard = Scaled-Position(0,0,100,100)
cardSize = Size(1000,1000)
//..Moreposiitons

ace = character(A) //This needs to be replaced with string.
two = character(2)
three = character(3)
four = character(4)
five = character(5)
six = character(6)
seven = character(7)
eight = character(8)
nine = character(9)
10 = character(10)
J = character(J)
Q = character(Q)
K = character(K)
</pre>
</div>

<pre class="example">
(define emptyFamily (family))
(define heartFamily (family (cons "suite" heartImage)))
(define diamondFamily (family (cons "suite" diamondImage)))
(define spadeFamily (family (cons "suite" spadeImage)))
(define clubFamily (family (cons "suite" clubImage)))

(define backgroundLayout 
  (layout 
  (cons (leaf-layout whiteRectangle) wholeCard)
  (cons (leaf-layout "suite") topRightCorner)
  (cons (leaf-layout "suite") bottomLeftCorner))
)

(define jackLayout 
  (layout 
  (cons backGroundLayout wholeCard)
  (cons (leaf-layout J) topRightCorner)
  (cons (leaf-layout J) bottomLeftCorner)
  (cons (leaf-layout jackImage) center))
)

(define queenLayout 
  (layout 
  (cons backGroundLayout wholeCard)
  (cons (leaf-layout Q) topRightCorner)
  (cons (leaf-layout Q) bottomLeftCorner)
  (cons (leaf-layout queenImage) center))
)

(define kingLayout 
  (layout 
  (cons backGroundLayout wholeCard)
  (cons (leaf-layout K) topRightCorner)
  (cons (leaf-layout K) bottomLeftCorner)
  (cons (leaf-layout kingImage) center))
)

(define KingCard 
  (card cardSize "King" kingLayout kingLayout)
)

(define JackCard 
  (card cardSize "Jack" JackLayout JackLayout)
)

(define QueenCard 
  (card cardSize "Queen" QueenLayout QueenLayout)
)

(define oneLayout
  (layout 
  (cons backGroundLayout wholeCard)
  (cons (leaf-layout one) topRightCorner)
  (cons (leaf-layout one) topLeftCorner)
  (cons (leaf-layout "suite") center)
)

(define oneCard (card cardSize "One" oneLayout oneLayout))
...

(define tenLayout
  (layout 
  (cons backGroundLayout wholeCard)
  (cons (leaf-layout ten) topRightCorner)
  (cons (leaf-layout ten) topLeftCorner)
  (cons (leaf-layout "suite") center-10-1)
  (cons (leaf-layout "suite") center-10-2)
  (cons (leaf-layout "suite") center-10-3)
  (cons (leaf-layout "suite") center-10-4)
  (cons (leaf-layout "suite") center-10-5)
  (cons (leaf-layout "suite") center-10-6)
  (cons (leaf-layout "suite") center-10-7)
  (cons (leaf-layout "suite") center-10-8)
  (cons (leaf-layout "suite") center-10-9)
  (cons (leaf-layout "suite") center-10-10)
)

(define tenCard (card cardSize "Ten" tenLayout tenLayout))


(define suite (list QueenCard JackCard KingCard oneCard ... tenCard))

(render suite heartFamily)
(render suite clubFamily)
(render suite diamondFamily)
(render suite spadeFamily)
</pre>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> Render method</h2>
<div class="outline-text-2" id="text-8">
<p>
The idea is that we
</p>
<ul class="org-ul">
<li>Calculate a size for our image, call this MainImage.
<ul class="org-ul">
<li>Calculate the size of this layout with the size given to us of parent, plus our relative width + height to that
</li>
</ul>
</li>
<li>If a composite, then
<ul class="org-ul">
<li>Make MainImage a transparent image with the earlier calculated size.
</li>
<li>For each child, call render again, passing in the position it is paired with in the composite
<ul class="org-ul">
<li>Pass through the family, and the subsize. 
</li>
</ul>
</li>
<li>For each child, take the image retrieved from the above step, and place it in the MainImage.
<ul class="org-ul">
<li>It will be placed at MainImage.size().x*x%, MainImage.size().y*y%
</li>
</ul>
</li>
<li>Return MainImage
</li>
</ul>
</li>
</ul>
<div class="org-src-container">

<pre class="src src-java">class CompositeLayout {
    //...Stuff elided
    Image render(ArrayList&lt;Family&gt; families, PositionScaled position, Size size) {
        Size sub_size = size; 
        sub_size.x*= (position.width/100);
        sub_size.y*= (position.height/100);
        Image image = new Image(sub_size.x,sub_size.y);
        Size sub_size = size; 
        for (LayoutAndPositionHolder pair : this.data) {
            SubImage = pair.layout.render(families,pair.position,sub_size);
            image.insertImage(subImage,
                              pair.position.x*(sub_size.x/100),
                              pair.position.y*(sub_size.y/100));
        }
        return image;
    }

}
</pre>
</div>
<ul class="org-ul">
<li>If a LeafLayout
<ul class="org-ul">
<li>Tell the decal to render at that calculated size.
</li>
<li>Return this image
</li>
</ul>
</li>
</ul>

<div class="org-src-container">

<pre class="src src-java">class LeafLayout {
     //... Stuff ellided

     Image render(ArrayList&lt;Family&gt; families, PositionScaled position, Size size) {
         Size sub_size = size; 
         sub_size.x*= (position.width/100);
         sub_size.y*= (position.height/100);
         Image sub_image = this.decal.render(families,sub_size);
         return sub_image;
     }
</pre>
</div>
<ul class="org-ul">
<li>Note how position is always handled by the parent.
</li>
</ul>

<p>
This process is started with the card, which will call
</p>
<div class="org-src-container">

<pre class="src src-java">class Card {
    //Stuff ellided
    Foo someMethod(ArrayList&lt;Family&gt; families,Some params...) {
      Image image = FrontLayout.render(families,new PositionScaled(0,0,100,100),this.size);
      Image image = BackLayout.render(families,new PositionScaled(0,0,100,100),this.size);
        Do something with these images...
    }
}
</pre>
</div>

<ul class="org-ul">
<li>Dynamic decal will look like this
<ul class="org-ul">
<li>Decals only need Families + size to be rendered
</li>
</ul>
</li>
</ul>
<div class="org-src-container">

<pre class="src src-java">class DynamicDecal {
    private String key;

    DynamicDecal(String key) {
        this.key = key;
    }

    Image render(ArrayList&lt;Family&gt; families, size) {
        for ( Family family : families ) {
            Decal decal = family.get(key);
            if ( decal != null ) {
                return decal.render(families,size);
            }
        }
        //If we get here, error, 
        //throw an exception or something,
        // and add an error to the user
        //error output, something like

        // "ERROR, DECAL OF NAME " + name + "Not found in given family!"
    }
}
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Design Patterns Team</p>
<p class="date">Created: 2015-11-18 Wed 17:55</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.5.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
