  #+BEGIN_SRC plantuml :file ConsBuilder.png
skinparam dpi 300
class ConsBuilder

abstract class ScriptObjectBuilder as "{abstract}\nScriptObjectBuilder"

ScriptObjectBuilder <|-- ConsBuilder
ConsBuilder : #addScriptObject(s:ScriptObject) 
ConsBuilder : +getResult() : ScriptObject 
ConsBuilder : +clone() : ConsBuilder
ConsBuilder : -state : State
ConsBuilder : -setState(s:State)
note top : clone : Just need to call clone on state attribute. Nothing else to worry about.
note left : Delegates addScriptObject, and getResult to state

abstract class State as "{abstract}\nState"


State : getResult(c:ConsBuilder) : ScriptObject
State : addScriptObject(s:ScriptObject,c:ConsBuilder) 

class Empty
Empty : getResult(c:ConsBuilder) : ScriptObject
Empty : addScriptObject(s:ScriptObject,c:ConsBuilder) 

note bottom of Empty
getResult : return an ErrorScriptObject, set state of c to new ErrorState.
addScriptObject : set state of c to new HalfFull State, give HalfFull s as it's ScriptObject.
end note

class HalfFull
HalfFull : HalfFull(one:ScriptObject)
HalfFull : one:ScriptObject
HalfFull : getResult(c:ConsBuilder) : ScriptObject
HalfFull : addScriptObject(s:ScriptObject,c:ConsBuilder) 

note bottom of HalfFull
getResult : return an ErrorScriptObject, set state of c to new ErrorState.
addScriptObject : set state of c to new Full State, give Full one, and s as it's two ScriptObjects
end note

class Full
Full : Full(one:ScriptObject,two:ScriptObject)
Full : one:ScriptObject
Full : two:ScriptObject
Full : getResult(c:ConsBuilder) : ScriptObject
Full : addScriptObject(s:ScriptObject,c:ConsBuilder) 

note bottom of Full
getResult : Return a ConsPair with one and two as the ScriptObjects
addScriptObject : Set state of c to new ErrorState
end note

class ErrorState
ErrorState : getResult(c:ConsBuilder) : ScriptObject
ErrorState : addScriptObject(s:ScriptObject,c:ConsBuilder) 

note bottom of ErrorState
getResult : return an ErrorScriptObject
addScriptObject : Do nothing, already an error
end note


ConsBuilder +-- State
State <|-- HalfFull
State <|-- Full
State <|-- ErrorState
State <|-- Empty





  #+END_SRC

  #+RESULTS:
  [[file:ConsBuilder.png]]

